<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI Hub</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      line-height: 1.6;
      background: linear-gradient(135deg, #0f0f0f 0%, #1a1a2e 50%, #16213e 100%);
      color: #fff;
    }
    .chat-container {
      backdrop-filter: blur(10px);
      background-color: rgba(26, 26, 26, 0.95);
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }
    .message.user {
      background: linear-gradient(135deg, #0a84ff, #006ee6);
      padding: 10px;
      border-radius: 10px;
      margin-bottom: 10px;
   istant {
      background-color: rgba(42, 42, 42, 0.8);
      border: 1px solid rgba(255,255,255,0.05);
      padding: 10px;
      border-radius: 10px;
      margin-bottom: 10px;
    }
    .model-select {
      margin: 10px 0;
      background-color: #1a1a2e;
      color: #fff;
      border: none;
      padding: 10px;
      border-radius: 5px;
    }
    .capability-card {
      border: 1px solid #444;
      padding: 10px;
      margin-top: 10px;
      background-color: rgba(0, 0, 0, 0.4);
      border-radius: 10px;
    }
    .model-tag {
      font-weight: bold;
      display: inline-block;
      margin-bottom: 10px;
    }
    ul#capability-list {
      list-style: none;
      padding-left: 0;
    }
    ul#capability-list li {
      margin: 4px 0;
    }
    .fas {
      color: #0a84ff;
      margin-right: 6px;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/puter.js@latest"></script>
</head>
<body>
  <div class="chat-container">
    <h2>🔧 AI Hub</h2>
    <select class="model-select" id="modelSelect" onchange="handleModelChange(this.value)">
      <option value="claude-3.5-sonnet">Claude 3.5 Sonnet</option>
      <option value="gpt-4-vision">GPT-4 Vision</option>
      <option value="llama-4-scout">LLaMA 4 Scout</option>
      <option value="amazon-polly">Amazon Polly</option>
      <option value="dall-e-3">DALL·E 3</option>
    </select>
    
    <div id="model-capability-display" class="capability-card">
      <div class="model-badge" id="active-model-badge"></div>
      <ul id="capability-list"></ul>
    </div>

    <div id="chatHistory">
      <div class="message user">What’s today’s weather and a quote?</div>
      <div class="message assistant" id="responseBlock">🌀 Awaiting model output...</div>
    </div>

    <div id="connection-status"></div>
    <div id="memoryStatus"></div>
  </div>

  <script>
    const MODEL_INTEGRATION = {
      "claude-3.5-sonnet": {
        apiPattern: () => puter.ai.workflow("Get me today's weather + quote", {memory: 'persistent'}),
        capabilities: ["JSON workflow generation", "200K context retention", "n8n optimization"],
        badge: "<span class='model-tag sonnet-tag'>🚀 Workflow Architect</span>"
      },
      "gpt-4-vision": {
        apiPattern: () => puter.ai.analyze(new Blob(), {model: 'gpt-4-vision'}),
        capabilities: ["Image analysis", "Chart interpretation", "Multimodal reasoning"],
        badge: "<span class='model-tag vision-tag'>👁️ Vision Expert</span>"
      },
      "llama-4-scout": {
        apiPattern: () => puter.kv.set('full-context', 'docs').then(() => puter.ai.process('kvRef')),
        capabilities: ["10M token capacity", "Codebase analysis", "Legal document processing"],
        badge: "<span class='model-tag scout-tag'>📚 Context Master</span>"
      },
      "amazon-polly": {
        apiPattern: () => puter.audio.synthesize("Hello world", {voice: 'Joanna', engine: 'neural'}),
        capabilities: ["Natural TTS", "Emotion control", "Real-time streaming"],
        badge: "<span class='model-tag tts-tag'>🔊 Speech Synthesis</span>"
      },
      "dall-e-3": {
        apiPattern: () => puter.creatives.render("a futuristic nebula", {size: '1024x1024', style: 'vivid'}),
        capabilities: ["Photorealistic images", "Inpainting/outpainting", "Style transfer"],
        badge: "<span class='model-tag creative-tag'>🎨 Digital Artist</span>"
      }
    };

    const PUBLIC_APIS = {
      weather: {
        endpoint: "https://api.open-meteo.com/v1/forecast",
        params: {latitude: 35.6895, longitude: 139.6917, hourly: "temperature_2m"},
        display: "WeatherDataParser"
      },
      quotes: {
        endpoint: "https://api.quotable.io/random",
        params: {maxLength: 100},
        display: "InspirationGenerator"
      },
      facts: {
        endpoint: "https://uselessfacts.jsph.pl/api/v2/facts/random",
        params: {language: "en"},
        display: "KnowledgeEnhancer"
      }
    };

    function updateCapabilityDisplay(model) {
      const { capabilities, badge } = MODEL_INTEGRATION[model];
      document.getElementById('active-model-badge').innerHTML = badge;
      const list = document.getElementById('capability-list');
      list.innerHTML = capabilities.map(cap =>
        "<li><i class='fas fa-check-circle'></i> " + cap + "</li>"
      ).join('');
    }

    function handleModelChange(selectedModel) {
      updateCapabilityDisplay(selectedModel);
      const responseEl = document.getElementById("responseBlock");
      MODEL_INTEGRATION[selectedModel].apiPattern()?.then(res => {
        responseEl.innerHTML = `<strong>🔧 AI Response:</strong> ${JSON.stringify(res)}`;
      }).catch(() => {
        responseEl.innerHTML = "⚠️ Failed to fetch AI response.";
      });

      // Public API parallel requests
      Promise.all([
        fetch(`${PUBLIC_APIS.weather.endpoint}?latitude=${PUBLIC_APIS.weather.params.latitude}&longitude=${PUBLIC_APIS.weather.params.longitude}&hourly=${PUBLIC_APIS.weather.params.hourly}`),
        fetch(`${PUBLIC_APIS.quotes.endpoint}?maxLength=${PUBLIC_APIS.quotes.params.maxLength}`)
      ])
      .then(async ([weatherRes, quoteRes]) => {
        const weatherData = await weatherRes.json();
        const quoteData = await quoteRes.json();
        responseEl.innerHTML += `<br><strong>${PUBLIC_APIS.weather.display}:</strong> ${JSON.stringify(weatherData)}<br><strong>${PUBLIC_APIS.quotes.display}:</strong> "${quoteData.content}" — ${quoteData.author}`;
      });
    }

    // Initial load
    handleModelChange("claude-3.5-sonnet");

    // Error-proofing
    if (typeof puter === "undefined") enableDemoMode();

    function enableDemoMode() {
      document.getElementById("responseBlock").innerHTML = "💡 Puter.js not loaded — Demo Mode enabled.";
    }
  </script>
</body>
</html>
